{"version":3,"file":"_server.ts-BK00w3A2.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/comic/_server.ts.js"],"sourcesContent":["import { j as json } from \"../../../../chunks/index.js\";\nimport { formatDistanceToNow } from \"date-fns\";\nasync function GET() {\n  let comic = await getComic();\n  return json(comic);\n}\nasync function getComic() {\n  let comic = {\n    title: \"\",\n    imageSrc: \"\",\n    alt: \"\",\n    date: \"\"\n  };\n  let rawComic = await fetchComic();\n  comic.title = rawComic.safe_title;\n  comic.imageSrc = rawComic.img;\n  comic.alt = rawComic.alt;\n  const date = new Date(rawComic.year, rawComic.month, rawComic.day);\n  const dateLocale = date.toLocaleString();\n  const relativeTime = buildRelativeTime(date);\n  comic.date = `Published: ${dateLocale} (${relativeTime})`;\n  return comic;\n}\nasync function fetchComic() {\n  const numberUrl = new URL(\"https://fwd.innopolis.university/api/hw2\");\n  numberUrl.searchParams.append(\"email\", \"s.dementev@innopolis.university\");\n  const number = await fetch(numberUrl).then((response) => response.json());\n  console.log(number);\n  const comicUrl = new URL(\"https://fwd.innopolis.university/api/comic\");\n  comicUrl.searchParams.append(\"id\", number);\n  return await fetch(comicUrl).then((response) => response.json());\n}\nfunction buildRelativeTime(date) {\n  const dayJsString = buildDayJsString(date);\n  return formatDistanceToNow(dayJsString, { addSuffix: true });\n}\nfunction buildDayJsString(date) {\n  return `${date.getFullYear()}-${date.getMonth()}-${date.getDay()}`;\n}\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;AAEA,eAAe,GAAG,GAAG;AACrB,EAAE,IAAI,KAAK,GAAG,MAAM,QAAQ,EAAE,CAAC;AAC/B,EAAE,OAAO,IAAI,CAAC,KAAK,CAAC,CAAC;AACrB,CAAC;AACD,eAAe,QAAQ,GAAG;AAC1B,EAAE,IAAI,KAAK,GAAG;AACd,IAAI,KAAK,EAAE,EAAE;AACb,IAAI,QAAQ,EAAE,EAAE;AAChB,IAAI,GAAG,EAAE,EAAE;AACX,IAAI,IAAI,EAAE,EAAE;AACZ,GAAG,CAAC;AACJ,EAAE,IAAI,QAAQ,GAAG,MAAM,UAAU,EAAE,CAAC;AACpC,EAAE,KAAK,CAAC,KAAK,GAAG,QAAQ,CAAC,UAAU,CAAC;AACpC,EAAE,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC,GAAG,CAAC;AAChC,EAAE,KAAK,CAAC,GAAG,GAAG,QAAQ,CAAC,GAAG,CAAC;AAC3B,EAAE,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,KAAK,EAAE,QAAQ,CAAC,GAAG,CAAC,CAAC;AACrE,EAAE,MAAM,UAAU,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;AAC3C,EAAE,MAAM,YAAY,GAAG,iBAAiB,CAAC,IAAI,CAAC,CAAC;AAC/C,EAAE,KAAK,CAAC,IAAI,GAAG,CAAC,WAAW,EAAE,UAAU,CAAC,EAAE,EAAE,YAAY,CAAC,CAAC,CAAC,CAAC;AAC5D,EAAE,OAAO,KAAK,CAAC;AACf,CAAC;AACD,eAAe,UAAU,GAAG;AAC5B,EAAE,MAAM,SAAS,GAAG,IAAI,GAAG,CAAC,0CAA0C,CAAC,CAAC;AACxE,EAAE,SAAS,CAAC,YAAY,CAAC,MAAM,CAAC,OAAO,EAAE,iCAAiC,CAAC,CAAC;AAC5E,EAAE,MAAM,MAAM,GAAG,MAAM,KAAK,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,KAAK,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC;AAC5E,EAAE,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;AACtB,EAAE,MAAM,QAAQ,GAAG,IAAI,GAAG,CAAC,4CAA4C,CAAC,CAAC;AACzE,EAAE,QAAQ,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;AAC7C,EAAE,OAAO,MAAM,KAAK,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,KAAK,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC;AACnE,CAAC;AACD,SAAS,iBAAiB,CAAC,IAAI,EAAE;AACjC,EAAE,MAAM,WAAW,GAAG,gBAAgB,CAAC,IAAI,CAAC,CAAC;AAC7C,EAAE,OAAO,mBAAmB,CAAC,WAAW,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;AAC/D,CAAC;AACD,SAAS,gBAAgB,CAAC,IAAI,EAAE;AAChC,EAAE,OAAO,CAAC,EAAE,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;AACrE;;;;"}